(()=>{function e(){var e=document.getElementById("settings-container"),t=document.getElementById("toggle-settings-btn"),n=t.dataset.textEdit,i=t.dataset.textClose;e.classList.contains("hidden")?(e.classList.remove("hidden"),t.textContent=i):(e.classList.add("hidden"),t.textContent=n)}function t(){var t=document.getElementById("email-settings").value;Office.context.roamingSettings.set("targetEmails",t),Office.context.roamingSettings.saveAsync(function(t){var i;t.status===Office.AsyncResultStatus.Succeeded?((i=document.getElementById("message-bar")).className="message-info",i.textContent="保存しました",i.style.display="block",setTimeout(function(){i.style.display="none"},3e3),n(),e()):function(e){var t=document.getElementById("message-bar");t.className="message-error",t.textContent=e,t.style.display="block"}("保存に失敗しました: "+t.error.message)})}function n(){if(Office.context.mailbox&&Office.context.mailbox.item){var e,t=Office.context.mailbox.item,n=(e=Office.context.roamingSettings.get("targetEmails")||"")?e.split(/[\n\r,]/).map(function(e){return e.trim().toLowerCase()}).filter(function(e){return e.length>0}):[],i=(t.to||[]).map(function(e){return e.emailAddress.toLowerCase()}),s=(t.cc||[]).map(function(e){return e.emailAddress.toLowerCase()}),o=n.filter(function(e){return i.includes(e)}),a=n.filter(function(e){return s.includes(e)});document.getElementById("result-to").innerText=o.length?o.join("\n"):"一致なし",document.getElementById("result-cc").innerText=a.length?a.join("\n"):"一致なし"}}Office.onReady(function(){var i;(i=Office.context.roamingSettings.get("targetEmails"))&&(document.getElementById("email-settings").value=i),n(),document.getElementById("save-btn").addEventListener("click",t),document.getElementById("toggle-settings-btn").addEventListener("click",e)})})();
//# sourceMappingURL=taskpane.js.map