{"version":3,"file":"taskpane.js","mappings":"MASA,SAASA,IACP,IAAMC,EAAYC,SAASC,eAAe,sBACpCC,EAAMF,SAASC,eAAe,uBAK9BE,EAAWD,EAAIE,QAAQD,SACvBE,EAAYH,EAAIE,QAAQC,UAG1BN,EAAUO,UAAUC,SAAS,WAE/BR,EAAUO,UAAUE,OAAO,UAC3BN,EAAIO,YAAcJ,IAGlBN,EAAUO,UAAUI,IAAI,UACxBR,EAAIO,YAAcN,EAEtB,CAUA,SAASQ,IACP,IAAMC,EAAUZ,SAASC,eAAe,kBAAkBY,MAG1DC,OAAOC,QAAQC,gBAAgBC,IAAI,eAAgBL,GACnDE,OAAOC,QAAQC,gBAAgBE,UAAU,SAAAC,GAW3C,IACQC,EAXAD,EAAYE,SAAWP,OAAOQ,kBAAkBC,YAWhDH,EAAMpB,SAASC,eAAe,gBAChCuB,UAAY,eAChBJ,EAAIX,YAZe,SAanBW,EAAIK,MAAMC,QAAU,QAGpBC,WAAW,WACTP,EAAIK,MAAMC,QAAU,MACtB,EAAG,KAjBCE,IACA9B,KAmBN,SAAyB+B,GACvB,IAAMT,EAAMpB,SAASC,eAAe,eACpCmB,EAAII,UAAY,gBAChBJ,EAAIX,YAAcoB,EAClBT,EAAIK,MAAMC,QAAU,OACtB,CAtBMI,CAAgB,cAAgBX,EAAYY,MAAMF,QAEtD,EACF,CA6BA,SAASD,IAEP,GAAKd,OAAOC,QAAQiB,SAAYlB,OAAOC,QAAQiB,QAAQC,KAAvD,CAEA,IAZmBC,EAYbD,EAAOnB,OAAOC,QAAQiB,QAAQC,KAI9BE,GAhBaD,EAcCpB,OAAOC,QAAQC,gBAAgBoB,IAAI,iBAAmB,IAZnEF,EACJG,MAAM,WACNC,IAAI,SAAAC,GAAC,OAAIA,EAAEC,OAAOC,aAAa,GAC/BC,OAAO,SAAAH,GAAC,OAAIA,EAAEI,OAAS,CAAC,GAJV,GAkBXC,GAAgBX,EAAKY,IAAM,IAAIP,IAAI,SAAAQ,GAAC,OAAIA,EAAEC,aAAaN,aAAa,GAEpEO,GAAgBf,EAAKgB,IAAM,IAAIX,IAAI,SAAAQ,GAAC,OAAIA,EAAEC,aAAaN,aAAa,GAGpES,EAAcf,EAAQO,OAAO,SAAAS,GAAC,OAAIP,EAAaQ,SAASD,EAAE,GAC1DE,EAAclB,EAAQO,OAAO,SAAAS,GAAC,OAAIH,EAAaI,SAASD,EAAE,GAEhEnD,SAASC,eAAe,aAAaqD,UACnCJ,EAAYP,OAASO,EAAYK,KAAK,MAAQ,OAEhDvD,SAASC,eAAe,aAAaqD,UACnCD,EAAYV,OAASU,EAAYE,KAAK,MAAQ,MArBmB,CAsBrE,CA1GAzC,OAAO0C,QAAQ,WA+Bf,IACQC,KAAQ3C,OAAOC,QAAQC,gBAAgBoB,IAAI,mBAG/CpC,SAASC,eAAe,kBAAkBY,MAAQ4C,GAjCpD7B,IAEA5B,SAASC,eAAe,YAAYyD,iBAAiB,QAAS/C,GAC9DX,SAASC,eAAe,uBAAuByD,iBAAiB,QAAS5D,EAC3E,E","sources":["webpack://office-addin-taskpane-js/./src/taskpane/taskpane.js"],"sourcesContent":["Office.onReady(() => {\n  loadSettings();\n  checkRecipients();\n  // イベントリスナーの登録\n  document.getElementById(\"save-btn\").addEventListener(\"click\", saveSettings);\n  document.getElementById(\"toggle-settings-btn\").addEventListener(\"click\", toggleSettings);\n});\n\n// 設定エリアの表示・非表示を切り替える\nfunction toggleSettings() {\n  const container = document.getElementById(\"settings-container\");\n  const btn = document.getElementById(\"toggle-settings-btn\");\n  \n  // HTMLの data-* 属性からテキストを取得\n  // data-text-edit -> dataset.textEdit\n  // data-text-close -> dataset.textClose\n  const textEdit = btn.dataset.textEdit;\n  const textClose = btn.dataset.textClose;\n  \n  // hiddenクラスの有無で判定\n  if (container.classList.contains(\"hidden\")) {\n    // 表示する処理\n    container.classList.remove(\"hidden\");\n    btn.textContent = textClose;\n  } else {\n    // 隠す処理\n    container.classList.add(\"hidden\");\n    btn.textContent = textEdit;\n  }\n}\n\nfunction loadSettings() {\n  const saved = Office.context.roamingSettings.get(\"targetEmails\");\n  // console.log(\"Loaded settings:\", saved);\n  if (saved) {\n    document.getElementById(\"email-settings\").value = saved;\n  }\n}\n\nfunction saveSettings() {\n  const content = document.getElementById(\"email-settings\").value;\n  // console.log(\"Saving settings:\", content);\n\n  Office.context.roamingSettings.set(\"targetEmails\", content);\n  Office.context.roamingSettings.saveAsync(asyncResult => {\n    if (asyncResult.status === Office.AsyncResultStatus.Succeeded) {\n      showInfoBanner(\"保存しました\");\n      checkRecipients();\n      toggleSettings();  // 保存成功時は設定エリアを閉じる\n    } else {\n      showErrorBanner(\"保存に失敗しました: \" + asyncResult.error.message);\n    }\n  });\n}\n\nfunction showInfoBanner(message) {\n  const bar = document.getElementById(\"message-bar\");\n  bar.className = \"message-info\";\n  bar.textContent = message;\n  bar.style.display = \"block\";\n\n  // 自動的に消す場合（3秒）\n  setTimeout(() => {\n    bar.style.display = \"none\";\n  }, 3000);\n}\n\nfunction showErrorBanner(message) {\n  const bar = document.getElementById(\"message-bar\");\n  bar.className = \"message-error\";\n  bar.textContent = message;\n  bar.style.display = \"block\";\n}\n\nfunction parseEmails(raw) {\n  if (!raw) return [];\n  return raw\n    .split(/[\\n\\r,]/)\n    .map(x => x.trim().toLowerCase())\n    .filter(x => x.length > 0);\n}\n\nfunction checkRecipients() {\n  // メール作成画面でない場合のエラーハンドリングが必要な場合はここに追加\n  if (!Office.context.mailbox || !Office.context.mailbox.item) return;\n\n  const item = Office.context.mailbox.item;\n\n  const rawSettings = Office.context.roamingSettings.get(\"targetEmails\") || \"\";\n  // console.log(\"Raw settings:\", rawSettings);\n  const targets = parseEmails(rawSettings);\n  // console.log(\"Checking recipients against targets:\", targets);\n\n  const toRecipients = (item.to || []).map(r => r.emailAddress.toLowerCase());\n  // console.log(\"To recipients:\", toRecipients);\n  const ccRecipients = (item.cc || []).map(r => r.emailAddress.toLowerCase());\n  // console.log(\"Cc recipients:\", ccRecipients);\n\n  const matchedInTo = targets.filter(t => toRecipients.includes(t));\n  const matchedInCc = targets.filter(t => ccRecipients.includes(t));\n\n  document.getElementById(\"result-to\").innerText =\n    matchedInTo.length ? matchedInTo.join(\"\\n\") : \"一致なし\";\n\n  document.getElementById(\"result-cc\").innerText =\n    matchedInCc.length ? matchedInCc.join(\"\\n\") : \"一致なし\";\n}\n"],"names":["toggleSettings","container","document","getElementById","btn","textEdit","dataset","textClose","classList","contains","remove","textContent","add","saveSettings","content","value","Office","context","roamingSettings","set","saveAsync","asyncResult","bar","status","AsyncResultStatus","Succeeded","className","style","display","setTimeout","checkRecipients","message","showErrorBanner","error","mailbox","item","raw","targets","get","split","map","x","trim","toLowerCase","filter","length","toRecipients","to","r","emailAddress","ccRecipients","cc","matchedInTo","t","includes","matchedInCc","innerText","join","onReady","saved","addEventListener"],"sourceRoot":""}